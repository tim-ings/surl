<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>sURL - tim-ings.com</title>

    <style>
      body {
        background-color: #353535;
        font-family: Consolas,monaco,monospace;
        color: #FFFFFF;
        margin: 0;
        padding: 0;
      }
      .title {
        display: inline-block;
        margin: 10px;
      }
      .title h2 {
        margin: 0;
        padding: 0;
        line-height: 1.8em;
        font-size: 1.7em;
      }
      .title h2 span {
        padding: .2em;
        background-color: rgba(29,29,29,.99);
        -webkit-box-decoration-break: clone;
        box-decoration-break: clone;
        border: 1px solid #fff;
      }

      .container {
        padding: 0;
        margin: 80px auto;
        width: 320px;
        height: 400px;
        border-radius: 10px;
        background-color: #404040;
        box-shadow: 5px 5px 15px 0 rgba(0,0,0,.25);
        overflow: hidden;
      }
      
      form {
        padding: 10px;
      }
      input {
        border: none;
        margin: 10px auto;
        font-family: Consolas,monaco,monospace;
      }
      input[type="text"], input[type="url"] {
        padding: 10px 20px;
        display: block;
        width: calc(100% - 42px);

        color: #ccc;
        border: 1px solid #ccc;
        background-color: #4a4a4a;
      }
      input:focus {
        border-color: #fff;
        color: #fff;
        outline: none;
        background-color: #404040;
      }
      input[type="submit"] {
        cursor: pointer;
        width: 100%;
        height: 40px;
        border: 1px solid #ccc;
        box-shadow: 5px 5px 15px 0 rgba(0,0,0,.25);
        background-color: #353535;
        color: #ccc;
      }
      input[type="submit"]:hover {
        color: #fff;
        border-color: #fff;
      }
    </style>
  </head>
  <body>
    <div class="container">
    <div class="title">
      <h2><span>sURL - URL Shortener</span></h2>
    </div>
      <form id="create-form">
        <input type="url" name="url" id="inp-url" placeholder="url" />
        <input type="text" name="slug" id="inp-slug" placeholder="slug" />
        <input type="submit" action="submit" value="Create" id="submit-btn" />
      </form>
      <p>
        <a id="short-link" href=""></a>
      </p>
    </div>
    <script>
      document.getElementById("create-form").addEventListener("submit", async (e) => {
        // prevent form submission
        e.preventDefault();
        // clear old anchor tag
        const link = document.getElementById("short-link");
        link.text = "";
        link.href = "";
        // create the shortened link
        const url = document.getElementById("inp-url").value;
        const slug = document.getElementById("inp-slug").value;
        const resp = await fetch("https://surl.tim-ings.com/run", {
          method: "POST",
          headers: {
            "Accept": "application/json",
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            url,
            slug,
          })
        });
        // update the anchor tag
        const data = await resp.json();
        link.text = data.url;
        link.href = data.url;
      });
    </script>
  </body>
</html>
